<!DOCTYPE html>

<html>
<head>
  <title>utils.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="DOM.html">
                DOM.js
              </a>
            
              
              <a class="source" href="LogX-console-transport.html">
                LogX-console-transport.js
              </a>
            
              
              <a class="source" href="LogX-jsonp-transport.html">
                LogX-jsonp-transport.js
              </a>
            
              
              <a class="source" href="LogX.html">
                LogX.js
              </a>
            
              
              <a class="source" href="PubSub.html">
                PubSub.js
              </a>
            
              
              <a class="source" href="base64.html">
                base64.js
              </a>
            
              
              <a class="source" href="browser.html">
                browser.js
              </a>
            
              
              <a class="source" href="cookie.html">
                cookie.js
              </a>
            
              
              <a class="source" href="events.html">
                events.js
              </a>
            
              
              <a class="source" href="extendProto.html">
                extendProto.js
              </a>
            
              
              <a class="source" href="namespace.html">
                namespace.js
              </a>
            
              
              <a class="source" href="utils.html">
                utils.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>utils.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * 
 * @module utilities
 * @author Ron Jansen &lt;ron@flipbase.com&gt;
 * @description all basic functionality for backbase, including _.assign,
 *              _.querystring, _.bind, _.keys, _.inherits, etc. This module is 
 *              heavily inspired on underscore, together with some basic utils.
 */</span>
<span class="hljs-keyword">var</span> utils = _ = {
  
  <span class="hljs-comment">/**
   * Parse and object to UTF-8 string format so it can be used in URL's
   * @param  {object} obj    object to parse
   * @param  {object} prefix name of the prefix, based on the val
   * @return {string}        
   */</span>
  querystring: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj, prefix</span>) </span>{
    <span class="hljs-keyword">var</span> str = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj) {
      <span class="hljs-keyword">if</span> (obj.hasOwnProperty(key)) {
        <span class="hljs-keyword">var</span> k = prefix ? prefix + <span class="hljs-string">"["</span> + key + <span class="hljs-string">"]"</span> : key;
        <span class="hljs-keyword">var</span> val = obj[key];
        
        str.push(_.isObject(val) ?
          _.querystring(val, k) :
          <span class="hljs-built_in">encodeURIComponent</span>(k) + <span class="hljs-string">"="</span> + <span class="hljs-built_in">encodeURIComponent</span>(val));
      }
    }
    <span class="hljs-keyword">return</span> str.join(<span class="hljs-string">"&amp;"</span>);
  },
  

  <span class="hljs-comment">/**
   * Create a new object based on the input object
   * @param  {object} obj
   * @return {object} 
   */</span>
  clone: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">return</span> _.assign({}, obj);
  },

  <span class="hljs-comment">/**
   * Equivalent method to underscore's _.extend method; but this method actually
   * also deep merges nested objects!
   * 
   * @param  {object} target object to copy all (sub)props to
   * @param  {object} source object to copy all props from
   * @return {object}        target with all props from source
   */</span>
  assign: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, source</span>) </span>{
    <span class="hljs-keyword">var</span> keys = _.keys(source);

    _.each(keys, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, i, list</span>) </span>{
      <span class="hljs-keyword">var</span> original = target[key];
      <span class="hljs-keyword">var</span> next = source[key];
      <span class="hljs-keyword">if</span> (original &amp;&amp; next &amp;&amp; <span class="hljs-keyword">typeof</span> next == <span class="hljs-string">"object"</span>) {
        _.assign(original, next);
      } <span class="hljs-keyword">else</span> {
        target[key] = source[key];
      }
    });
    <span class="hljs-keyword">return</span> target;
  },

  <span class="hljs-comment">/**
   * Prototypal inheritance based on http://javascript.crockford.com/prototypal.html
   * @param  {Object}   proto the prototype to inherit from
   * @return {Function}       the new created function with protoype       
   */</span>
  inherits: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">proto</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">F</span>(<span class="hljs-params"></span>) </span>{}
    F.prototype = proto;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> F();
  },

  <span class="hljs-comment">/**
   * Verify if object is really an object.
   * @param  {object}  obj 
   * @return {Boolean}     
   */</span>
  isObject: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">var</span> type = <span class="hljs-keyword">typeof</span> obj;
    <span class="hljs-keyword">return</span> type === <span class="hljs-string">'function'</span> || type === <span class="hljs-string">'object'</span> &amp;&amp; !!obj;
  },

  <span class="hljs-comment">/**
   * Copied from underscore.js
   * @return {Boolean} true if obj is an array
   */</span>
  isArray: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">return</span> toString.call(obj) === <span class="hljs-string">'[object Array]'</span>;
  },

  <span class="hljs-comment">/**
   * Bind 'this' to a method
   * @param  {Object}   context "this"
   * @param  {Function} fn      method to bind 'this' to
   * @return {Function}         newly created method with 'this' as context
   */</span>
  bind: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">context, fn</span>) </span>{
    fn = fn;
    context = context;
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> args = [].slice.call(<span class="hljs-built_in">arguments</span>) || [];
      fn.apply(context, args);
    };
  },
  <span class="hljs-comment">/**
   * Utility to prevet default actions when listening to DOM events.
   * @param  {Object} evt event object from DOM
   */</span>
  preventDefault: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
    <span class="hljs-keyword">if</span> (evt.preventDefault) {
      evt.preventDefault();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (evt.returnValue) {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>IE8&lt;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      evt.returnValue = <span class="hljs-literal">false</span>;
    }
  },

  <span class="hljs-comment">/**
   * This code does not work in IE9 and lower!
   * 
   * @param  {object} obj object to parse
   * @return {array}      array with all keys
   */</span>
  keys: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">var</span> props = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj) props.push(key);

    <span class="hljs-keyword">return</span> props;
  },

  <span class="hljs-comment">/**
   * Iterate over array and execute callback on each index
   * @param  {array}    arr 
   * @param  {Function} cb 
   */</span>
  each: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arr, cb</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; arr.length &gt; i; i++) cb(arr[i], i, arr);
  },
  
  <span class="hljs-comment">/**
   * Verify if string is a valid UUID (v1 or v4)
   * @param  {string}  uuid 
   * @return {Boolean}
   */</span>
  isUUID: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">uuid</span>) </span>{
    <span class="hljs-keyword">var</span> regex = <span class="hljs-regexp">/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/</span>;
    <span class="hljs-keyword">return</span> regex.test(uuid);
  },

  <span class="hljs-comment">/**
   * Verify if input is a number
   * @param  {number}  n number
   * @return {Boolean}
   */</span>
  isNumber: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">return</span> n === <span class="hljs-built_in">parseFloat</span>(n);
  },

  <span class="hljs-comment">/**
   * Verify if a number is even or uneven
   * @param  {number}  n number
   * @return {Boolean}   true if n=2, n=4, etc
   */</span>
  isEven: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">return</span> _.isNumber(n) &amp;&amp; (n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
  },

  <span class="hljs-comment">/**
   * Returns the index of a certain value in an array
   * @param  {array}  arr   
   * @param  {object} val   
   * @param  {number} start index to start the search
   * @return {number} index of value if found; if not -1 is returned
   */</span>
  getIndex: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arr, val, start</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = (start || <span class="hljs-number">0</span>); i &lt; arr.length; i++) {
      <span class="hljs-keyword">if</span> (arr[i] === val) <span class="hljs-keyword">return</span> i;
    }
    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
  },

  <span class="hljs-comment">/**
   * Shorthand to verify if value|objects are equal.
   * @param  {object} val1
   * @param  {object} val2 
   * @return {boolean}     
   */</span>
  eq: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val1, val2</span>) </span>{
    <span class="hljs-keyword">return</span> (val1 === val2);
  },

  <span class="hljs-comment">/**
   * Shorthand utility to check the type of an attribute
   * @param  {string}  attr 
   * @param  {string}  type  
   * @return {Boolean}
   */</span>
  is: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr, type</span>) </span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> attr === type);
  },

  <span class="hljs-comment">/**
   * Chrome ships with their own Flash Player embedded, named 'Pepper Flash'
   * Performance with regards to Netstream methods is much lower compared to the
   * official Adobe Flash Player. If both are installed and active, Chrome still prefers
   * Pepper Flash.
   * @return {boolean} true if Pepper Flash is present and actived
   */</span>
  checkForPepper: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (navigator.mimeTypes &amp;&amp;
      navigator.mimeTypes[<span class="hljs-string">'application/x-shockwave-flash'</span>] &amp;&amp;
      <span class="hljs-string">'chrome'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {
      <span class="hljs-keyword">var</span> filename = navigator.mimeTypes[<span class="hljs-string">'application/x-shockwave-flash'</span>].enabledPlugin.filename;

      <span class="hljs-keyword">if</span> (filename === <span class="hljs-string">'pepflashplayer.dll'</span> ||
        filename === <span class="hljs-string">'libpepflashplayer.so'</span> ||
        filename === <span class="hljs-string">'PepperFlashPlayer.plugin'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },

  <span class="hljs-comment">/**
   * Check if video's can be uploaded, if XHR2 is supported
   * @return {Boolean}
   */</span>
  hasXHR2: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">window</span>.FormData !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-built_in">window</span>.FileReader &amp;&amp;
      <span class="hljs-built_in">window</span>.FileList &amp;&amp; <span class="hljs-built_in">window</span>.Blob) ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
  }

};

<span class="hljs-built_in">module</span>.exports = utils;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
